# /etc/pam.d/sshd-custom
# Configuration PAM personnalisée pour SSH
# Gestion des groupes d'utilisateurs et contrôle d'accès

# ============================================
# AUTHENTIFICATION
# ============================================

# Authentification standard Unix/Linux
# Vérifie le mot de passe dans /etc/shadow
auth       required     pam_unix.so nullok try_first_pass

# Vérification du groupe
# Vérifie l'appartenance aux groupes autorisés
auth       required     pam_group.so use_first_pass

# Contrôle d'accès
# Consulte /etc/security/access.conf
auth       required     pam_access.so

# ============================================
# GESTION DES SESSIONS
# ============================================

# Application des limites de ressources
# Applique les limites définies dans /etc/security/limits.conf
session    required     pam_limits.so

# Gestion de la session Unix
session    required     pam_unix.so

# ============================================
# GESTION DES MOTS DE PASSE
# ============================================

# Mise à jour des mots de passe
password   required     pam_unix.so obscure sha512 rounds=5000
